# 이벤트 기반 아키텍처 (EDA)

- 어플리케이션 간 설계를 위한 소프트웨어 아키텍처 및 모델이다.
- 이는 분리된 서비스들 간의 이벤트를 전달하기 위해서 설계 되었다.

## 이벤트란?

모든 중요한 발생 혹은 변경 사항에 대한 기록이다.

## 이벤트 기반 아키텍처의 구성 요소

1. event producers (publishers)

- 이벤트를 인지하거나 찾는다.

- 이벤트를 메시지로 표현한다.

- decoupling 하게 구성되기 때문에 이벤트의 consumer 와 이벤트의 결과를 알지 못한다.

- 이벤트의 channel 을 통해서 consumer 에게 전달된다.


2. event consumers (subscribers)

- 이벤트가 발행되면 알게 된다.

- 이벤트를 처리하거나 영향을 받는다.


3. event processing platform

- 이벤트에 대한 올바른 응답을 실행한다.

## 이벤트 기반 아키텍처의 모델

1. pub/sub model

- 특정 부분을 구독하고 있다가 이벤트가 발생하거나 발행되면 구독자들은 이를 알게 되고 이벤트를 수신하게 되는 방식


2. event streaming model

- 이벤트가 로그로 기록된다.

- event consumer 은 구독하지 않는다.

- consumer 들은 stream 의 어떤 부분이든 읽을 수 있고, 언제든지 stream 에 조인할 수 있다.

- apache kafka 와 같은 streaming platform 을 이용한다.

# Event 를 사용하는 이유

- event 를 기반으로 하여 아키텍처를 고려하게 되면, 서비스 간의 의존성이 분리된다.

```
예를 들어서, 이커머스 서비스에서
1. 주문을 하면

2. 포인트를 지급하고

3. 추천 상품에 대한 알고리즘의 로직을 변경해야 한다고 가정해보자.

위에서 언급한 3가지의 로직은 모두 서로 연관이 없으며 의존해서는 안된다는 것을 알 수 있을 것이다.
```

- 만약 이벤트를 이용해 서로 분리하지 않는다면 다음과 같이 코드가 작성될 것이다.

```java
public class OrderService {
    public void order(OrderRequestDto orderRequestDto) {
        주문(orderRequestDto);
        포인트_지급(포인트 지급에 필요한 파라미터);
        추천_상품_알고리즘_변경(알고리즘 변경에 필요한 파라미터);
    }
}
```

- 만약, 포인트 지급에 필요했던 정보가 바뀐다고 가정해보자. 그렇게 되면 OrderService 즉 주문에 대한 로직에 변경이 전파된다. 서로 연관이 없는 로직끼리의 의존이 생기게 되는 것이다. 이런 경우에
  이벤트의 발행이 필요해지는 것이다.

